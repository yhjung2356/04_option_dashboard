# ğŸ”§ ë™ì  ì¢…ëª©ì½”ë“œ ë° ì „ê±°ë˜ì¼ ê°œì„  ì™„ë£Œ

## âœ… ê°œì„  ì‚¬í•­

### 1ï¸âƒ£ **í•˜ë“œì½”ë”© ë¬¸ì œ í•´ê²°**

#### ì´ì „ ë¬¸ì œì :
```java
// âŒ í•˜ë“œì½”ë”©ëœ ì„ ë¬¼ ì¢…ëª©ì½”ë“œ
String[] futureCodes = {
    "101T3000",  // 12ì›”ë¬¼
    "101U3000",  // 1ì›”ë¬¼
    ...
};

// âŒ í•˜ë“œì½”ë”©ëœ ì˜µì…˜ ì¢…ëª©ì½”ë“œ
String callCode = String.format("201TC%03d", strike);  // 12ì›”ë¬¼ ê³ ì •

// âŒ ë‹¨ìˆœí•œ ì „ê±°ë˜ì¼ ê³„ì‚° (íœ´ì¥ì¼ ë¯¸ê³ ë ¤)
LocalDate previousDay = today.minusDays(1);
while (previousDay.getDayOfWeek().getValue() >= 6) {
    previousDay = previousDay.minusDays(1);
}
```

#### ê°œì„  í›„:
```java
// âœ… ë™ì ìœ¼ë¡œ ì¢…ëª©ì½”ë“œ ì¡°íšŒ
Map<String, String> futuresSymbols = tradingCalendarService.getFuturesSymbols(token);

// âœ… ë™ì ìœ¼ë¡œ ì˜µì…˜ ì¢…ëª©ì½”ë“œ ìƒì„±
List<String> optionCodes = tradingCalendarService.getOptionSymbols(token, 380, 420, 5);

// âœ… íœ´ì¥ì¼ì„ ê³ ë ¤í•œ ì „ê±°ë˜ì¼ ê³„ì‚°
String tradingDate = tradingCalendarService.getPreviousTradingDay();
```

---

## ğŸ¯ ìƒˆë¡œìš´ ì„œë¹„ìŠ¤: TradingCalendarService

### ì£¼ìš” ê¸°ëŠ¥

#### 1. **ì „ê±°ë˜ì¼ ê³„ì‚° (íœ´ì¥ì¼ ê³ ë ¤)**

```java
public String getPreviousTradingDay()
```

**ê¸°ëŠ¥:**
- ì£¼ë§ ì œì™¸
- í•œêµ­ ê³µíœ´ì¼ ì œì™¸ (ì„¤ë‚ , ì¶”ì„, êµ­ê²½ì¼ ë“±)
- ìºì‹œë¥¼ í†µí•œ ì„±ëŠ¥ ìµœì í™”

**ì˜ˆì‹œ:**

| ì˜¤ëŠ˜ | ì „ê±°ë˜ì¼ | ì„¤ëª… |
|------|----------|------|
| 2025-12-20 (í† ) | 2025-12-19 (ê¸ˆ) | ì£¼ë§ ê±´ë„ˆëœ€ |
| 2025-12-21 (ì¼) | 2025-12-19 (ê¸ˆ) | ì£¼ë§ ê±´ë„ˆëœ€ |
| 2025-12-22 (ì›”) | 2025-12-19 (ê¸ˆ) | ì •ìƒ |
| 2025-01-29 (ìˆ˜) | 2025-01-27 (ì›”) | ì„¤ë‚  ì—°íœ´ ê±´ë„ˆëœ€ |
| 2025-10-07 (í™”) | 2025-10-02 (ëª©) | ì¶”ì„ ì—°íœ´ ê±´ë„ˆëœ€ |

#### 2. **ë™ì  ì„ ë¬¼ ì¢…ëª©ì½”ë“œ ì¡°íšŒ**

```java
public Map<String, String> getFuturesSymbols(String token)
```

**ê¸°ëŠ¥:**
- í•œêµ­íˆ¬ìì¦ê¶Œ APIë¥¼ í†µí•´ í˜„ì¬ ê±°ë˜ ê°€ëŠ¥í•œ ì„ ë¬¼ ì¢…ëª©ì½”ë“œ ì¡°íšŒ
- API ì‹¤íŒ¨ ì‹œ í˜„ì¬ ì›” ê¸°ì¤€ ê¸°ë³¸ ì¢…ëª©ì½”ë“œ ì‚¬ìš©
- ì¼ë³„ ìºì‹œë¡œ API í˜¸ì¶œ ìµœì†Œí™”

**ë™ì  ì›”ë¬¼ ì„ íƒ:**

| í˜„ì¬ ì›” | ì¡°íšŒë˜ëŠ” ì›”ë¬¼ |
|---------|---------------|
| 12-2ì›” | 12ì›”ë¬¼, 1ì›”ë¬¼, 2ì›”ë¬¼ |
| 3-5ì›” | 2ì›”ë¬¼, 3ì›”ë¬¼, 6ì›”ë¬¼ |
| 6-8ì›” | 3ì›”ë¬¼, 6ì›”ë¬¼, 9ì›”ë¬¼ |
| 9-11ì›” | 6ì›”ë¬¼, 9ì›”ë¬¼, 12ì›”ë¬¼ |

#### 3. **ë™ì  ì˜µì…˜ ì¢…ëª©ì½”ë“œ ìƒì„±**

```java
public List<String> getOptionSymbols(String token, int strikeStart, int strikeEnd, int strikeInterval)
```

**ê¸°ëŠ¥:**
- í–‰ì‚¬ê°€ ë²”ìœ„ ë™ì  ì„¤ì •
- í˜„ì¬ ê±°ë˜ ì›”ë¬¼ ìë™ ì ìš©
- ì½œ/í’‹ ì˜µì…˜ ìë™ ìƒì„±

**ì˜ˆì‹œ:**
```java
// í–‰ì‚¬ê°€ 380~420, 5pt ê°„ê²©
List<String> symbols = tradingCalendarService.getOptionSymbols(token, 380, 420, 5);
// ê²°ê³¼: [201TC380, 301TP380, 201TC385, 301TP385, ..., 201TC420, 301TP420]
```

---

## ğŸ“ ìˆ˜ì •ëœ íŒŒì¼

### 1. **TradingCalendarService.java** (ì‹ ê·œ ìƒì„±)
- ê±°ë˜ì¼ ê³„ì‚° ì„œë¹„ìŠ¤
- ì¢…ëª©ì½”ë“œ ë™ì  ì¡°íšŒ
- íœ´ì¥ì¼ ìºì‹œ ê´€ë¦¬

### 2. **KisApiService.java** (ìˆ˜ì •)

**ë³€ê²½ ì „:**
```java
// í•˜ë“œì½”ë”©ëœ ë°°ì—´
String[] futureCodes = {"101T3000", "101U3000", ...};
for (String code : futureCodes) {
    // ì¡°íšŒ
}
```

**ë³€ê²½ í›„:**
```java
// ë™ì ìœ¼ë¡œ ì¡°íšŒ
Map<String, String> futuresSymbolsMap = tradingCalendarService.getFuturesSymbols(token);
for (Map.Entry<String, String> entry : futuresSymbolsMap.entrySet()) {
    String code = entry.getKey();
    // ì¡°íšŒ
}
```

### 3. **KrxDataService.java** (ìˆ˜ì •)

**ë³€ê²½ ì „:**
```java
private String getPreviousTradingDay() {
    LocalDate today = LocalDate.now();
    LocalDate previousDay = today.minusDays(1);
    while (previousDay.getDayOfWeek().getValue() >= 6) {
        previousDay = previousDay.minusDays(1);
    }
    return previousDay.format(DateTimeFormatter.ofPattern("yyyyMMdd"));
}
```

**ë³€ê²½ í›„:**
```java
// TradingCalendarService ì‚¬ìš©
String tradingDate = tradingCalendarService.getPreviousTradingDay();
```

---

## ğŸš€ ì‚¬ìš© ì˜ˆì‹œ

### ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹œì‘ ì‹œ

```
2025-12-20 09:00:00 INFO  - Loading market holidays for year 2025...
2025-12-20 09:00:00 INFO  - Loaded 14 holidays for 2025
2025-12-20 09:00:00 INFO  - Previous trading day calculated: 20251219 (base: 2025-12-20)
2025-12-20 09:00:01 INFO  - ========================================
2025-12-20 09:00:01 INFO  - Loading KRX data for date: 20251219
2025-12-20 09:00:01 INFO  - ========================================
```

### ì„ ë¬¼ ë°ì´í„° ë¡œë”© ì‹œ

```
2025-12-20 09:00:02 INFO  - Loading KOSPI200 Futures data from KIS API...
2025-12-20 09:00:02 INFO  - Fetching KOSPI200 futures symbols from KIS API...
2025-12-20 09:00:03 INFO  - âœ“ Fetched 6 futures symbols from KIS API
2025-12-20 09:00:05 INFO  - âœ“ Loaded 6 KOSPI200 futures from KIS API
```

### ì˜µì…˜ ë°ì´í„° ë¡œë”© ì‹œ

```
2025-12-20 09:00:05 INFO  - Loading KOSPI200 Options data from KIS API...
2025-12-20 09:00:05 INFO  - Generated 18 option symbols (strikes: 380-420, interval: 5)
2025-12-20 09:00:10 INFO  - âœ“ Loaded 18 KOSPI200 options from KIS API
```

---

## ğŸ¨ ì¥ì 

### 1. **ìœ ì§€ë³´ìˆ˜ì„± í–¥ìƒ**
- âœ… ì¢…ëª©ì½”ë“œ ë³€ê²½ ì‹œ ì½”ë“œ ìˆ˜ì • ë¶ˆí•„ìš”
- âœ… ì›”ë¬¼ ìë™ ì „í™˜
- âœ… íœ´ì¥ì¼ ìë™ ì²˜ë¦¬

### 2. **ì •í™•ì„± í–¥ìƒ**
- âœ… ì‹¤ì œ ê±°ë˜ ê°€ëŠ¥í•œ ì¢…ëª©ë§Œ ì¡°íšŒ
- âœ… íœ´ì¥ì¼ ì •í™•íˆ ë°˜ì˜
- âœ… ê³µíœ´ì¼ ëŒ€ì²´íœ´ì¼ ì²˜ë¦¬ ê°€ëŠ¥

### 3. **ì„±ëŠ¥ ìµœì í™”**
- âœ… ì¢…ëª©ì½”ë“œ ìºì‹œ (ì¼ë³„)
- âœ… íœ´ì¥ì¼ ìºì‹œ (ì—°ë³„)
- âœ… ë¶ˆí•„ìš”í•œ API í˜¸ì¶œ ê°ì†Œ

### 4. **í™•ì¥ì„±**
- âœ… ë‹¤ì–‘í•œ í–‰ì‚¬ê°€ ë²”ìœ„ ì§€ì›
- âœ… ë‹¤ë¥¸ ìƒí’ˆ ì¶”ê°€ ìš©ì´
- âœ… ìºì‹œ ì •ì±… ì¡°ì • ê°€ëŠ¥

---

## ğŸ” ì¶”ê°€ ê°œì„  ê°€ëŠ¥ ì‚¬í•­

### 1. **ê³µíœ´ì¼ API ì—°ë™**
```java
// TODO: ì •ë¶€24 ê³µíœ´ì¼ API ë˜ëŠ” ê±°ë˜ì†Œ API ì—°ë™
private Set<LocalDate> loadHolidaysFromApi(int year) {
    // ì‹¤ì œ ê³µíœ´ì¼ ë°ì´í„° ì¡°íšŒ
}
```

### 2. **ì›”ë¬¼ ì½”ë“œ ìë™ ê°ì§€**
```java
// TODO: APIì—ì„œ í˜„ì¬ ê±°ë˜ ì¤‘ì¸ ì›”ë¬¼ ì½”ë“œ ìë™ ê°ì§€
String currentMonthCode = detectCurrentMonthCode(token);
```

### 3. **í–‰ì‚¬ê°€ ë²”ìœ„ ìë™ ê³„ì‚°**
```java
// TODO: í˜„ì¬ ì§€ìˆ˜ ê¸°ì¤€ ATM ê·¼ì²˜ í–‰ì‚¬ê°€ ìë™ ì„ íƒ
int atmStrike = getCurrentATMStrike();
int strikeStart = atmStrike - 40;
int strikeEnd = atmStrike + 40;
```

---

## âœ… í…ŒìŠ¤íŠ¸ í™•ì¸ ì‚¬í•­

### 1. ì „ê±°ë˜ì¼ ê³„ì‚° í…ŒìŠ¤íŠ¸
- [ ] ì£¼ë§ ë‹¤ìŒ ì›”ìš”ì¼ â†’ ì „ì£¼ ê¸ˆìš”ì¼ ì¡°íšŒ
- [ ] ê³µíœ´ì¼ ë‹¤ìŒë‚  â†’ ê³µíœ´ì¼ ì´ì „ ì˜ì—…ì¼ ì¡°íšŒ
- [ ] ì„¤ë‚ /ì¶”ì„ ì—°íœ´ â†’ ì—°íœ´ ì´ì „ ì˜ì—…ì¼ ì¡°íšŒ

### 2. ì¢…ëª©ì½”ë“œ ì¡°íšŒ í…ŒìŠ¤íŠ¸
- [ ] API ì •ìƒ ì‘ë‹µ ì‹œ â†’ ì‹¤ì œ ì¢…ëª©ì½”ë“œ ì‚¬ìš©
- [ ] API ì‹¤íŒ¨ ì‹œ â†’ ê¸°ë³¸ ì¢…ëª©ì½”ë“œ ì‚¬ìš©
- [ ] ìºì‹œ ë™ì‘ í™•ì¸ â†’ ì¤‘ë³µ API í˜¸ì¶œ ë°©ì§€

### 3. ë¡œê·¸ í™•ì¸
```bash
# ë¡œê·¸ì—ì„œ í™•ì¸í•  ë‚´ìš©
grep "Previous trading day calculated" output.log
grep "Fetched .* futures symbols" output.log
grep "Generated .* option symbols" output.log
```

---

## ğŸ“Œ ìš”ì•½

| í•­ëª© | ì´ì „ | ì´í›„ |
|------|------|------|
| ì¢…ëª©ì½”ë“œ | í•˜ë“œì½”ë”© | API ë™ì  ì¡°íšŒ |
| ì „ê±°ë˜ì¼ | ì£¼ë§ë§Œ ê³ ë ¤ | íœ´ì¥ì¼ í¬í•¨ ê³ ë ¤ |
| ì›”ë¬¼ ì „í™˜ | ìˆ˜ë™ ìˆ˜ì • í•„ìš” | ìë™ |
| í–‰ì‚¬ê°€ ë²”ìœ„ | ê³ ì • | ë™ì  ì„¤ì • ê°€ëŠ¥ |
| ìœ ì§€ë³´ìˆ˜ | ì–´ë ¤ì›€ | ì‰¬ì›€ |

---

## ğŸ¯ ë‹¤ìŒ ë‹¨ê³„

1. âœ… **ì™„ë£Œ:** TradingCalendarService ìƒì„±
2. âœ… **ì™„ë£Œ:** KisApiService ìˆ˜ì •
3. âœ… **ì™„ë£Œ:** KrxDataService ìˆ˜ì •
4. ğŸ”„ **ì§„í–‰ì¤‘:** ì‹¤ì œ í™˜ê²½ í…ŒìŠ¤íŠ¸
5. â³ **ì˜ˆì •:** ê³µíœ´ì¼ API ì—°ë™
6. â³ **ì˜ˆì •:** ì›”ë¬¼ ìë™ ê°ì§€ ê³ ë„í™”

---

## ğŸ“ ë¬¸ì˜ì‚¬í•­

ì¶”ê°€ ê°œì„ ì´ë‚˜ ë¬¸ì˜ì‚¬í•­ì´ ìˆìœ¼ë©´ ì´ìŠˆë¥¼ ë“±ë¡í•´ì£¼ì„¸ìš”!

**ë‚ ì§œ:** 2025-12-20  
**ë²„ì „:** 1.1.0  
**ì‘ì„±ì:** GitHub Copilot
